<!DOCTYPE HTML>
<html lang="null">
<head>
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="五年C++程序员的口水博客">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="https://israel-liu.github.io">
    <!--SEO-->





<meta name="robots" content="all" />
<meta name="google" content="all" />
<meta name="googlebot" content="all" />
<meta name="verify" content="all" />
    <!--Title-->


<title>Get Started with Win32 and C++ | 五年C++程序员的口水博客</title>


    <link rel="alternate" href="/atom.xml" title="五年C++程序员的口水博客" type="application/atom+xml">


    <link rel="icon" href="/favicon.ico">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>






    
</head>


<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(https://github.com/israel-Liu/theForger/raw/master/images/byosoku.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='Licca Chen'>
            <img src="/img/avatar.JPG" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                 <img src="/img/branding.png" alt="Snippet 博客主题" class="img-responsive center-block">
            
    	</div>
    </div>
</header>

    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="https://israel-liu.github.io">五年C++程序员的口水博客</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>Home</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>timeline</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/"><i class="fa "></i>Tags</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/about/"><i class="fa "></i>About</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>

    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="Get Started with Win32 and C++">
            
	            Get Started with Win32 and C++
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/ ">
             
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2018/09/12</span>
        </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h4 id="Get-Started-with-Win32-and-C"><a href="#Get-Started-with-Win32-and-C" class="headerlink" title="Get Started with Win32 and C++"></a><a href="https://docs.microsoft.com/en-ca/windows/desktop/LearnWin32/learn-to-program-for-windows" target="_blank" rel="noopener">Get Started with Win32 and C++</a></h4><h3 id="Windows-Coding-Conventions"><a href="#Windows-Coding-Conventions" class="headerlink" title="Windows Coding Conventions"></a>Windows Coding Conventions</h3><p>The vast majority of Windows APIs consist of either functions or Component Object Model (COM) interfaces.<br>Very few Windows APIs are provided as C++ classes. (A notable exception is GDI+, one of the 2-D graphics APIs.)</p>
<h4 id="Boolean-Type"><a href="#Boolean-Type" class="headerlink" title="Boolean Type"></a>Boolean Type</h4><p>Despite this definition of TRUE, however, most functions that return a BOOL type can return any non-zero value to indicate Boolean truth.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Right way.</span></span><br><span class="line">BOOL result = SomeFunctionThatReturnsBoolean();</span><br><span class="line"><span class="keyword">if</span> (result) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Pointer-Precision-Types"><a href="#Pointer-Precision-Types" class="headerlink" title="Pointer Precision Types"></a>Pointer Precision Types</h4><p>The following data types are always the size of a pointer—that is, 32 bits wide in 32-bit applications, and 64 bits wide in 64-bit applications. The size is determined at compile time. When a 32-bit application runs on 64-bit Windows, these data types are still 4 bytes wide. (A 64-bit application cannot run on 32-bit Windows, so the reverse situation does not occur.)<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DWORD_PTR</span><br><span class="line">INT_PTR</span><br><span class="line">LONG_PTR</span><br><span class="line">ULONG_PTR</span><br><span class="line">UINT_PTR</span><br></pre></td></tr></table></figure></p>
<p>These types are used in situations where an integer might be cast to a pointer. They are also used to define variables for pointer arithmetic and to define loop counters that iterate over the full range of bytes in memory buffers. More generally, they appear in places where an existing 32-bit value was expanded to 64 bits on 64-bit Windows.</p>
<h3 id="Working-with-Strings"><a href="#Working-with-Strings" class="headerlink" title="Working with Strings"></a>Working with Strings</h3><p>Windows represents Unicode characters using UTF-16 encoding, in which each character is encoded as a 16-bit value.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Some headers use the preprocessor symbol UNICODE, others use _UNICODE with an underscore prefix.</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> UNICODE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SetWindowText  SetWindowTextW</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SetWindowText  SetWindowTextA</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="comment">// CRT</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> _UNICODE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _tcslen     wcslen</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _tcslen     strlen</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></p>
<h3 id="WinMain-The-Application-Entry-Point"><a href="#WinMain-The-Application-Entry-Point" class="headerlink" title="WinMain: The Application Entry Point"></a>WinMain: The Application Entry Point</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> WINAPI <span class="title">wWinMain</span><span class="params">(HINSTANCE hInstance, HINSTANCE hPrevInstance, PWSTR pCmdLine, <span class="keyword">int</span> nCmdShow)</span></span>;</span><br></pre></td></tr></table></figure>
<p>hInstance is something called a “handle to an instance” or “handle to a module.” The operating system uses this value to identify the executable (EXE) when it is loaded in memory.值为在内存中的基地址首选0x0040 0000可以修改。</p>
<h3 id="Creating-a-Window"><a href="#Creating-a-Window" class="headerlink" title="Creating a Window"></a>Creating a Window</h3><p>Every window must be associated with a window class, even if your program only ever creates one instance of that class.<br>For each thread that creates a window, the operating system creates a queue for window messages.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MSG msg;</span><br><span class="line">BOOL bRet;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">0</span> != (bRet = ::GetMessage(&amp;msg, <span class="literal">nullptr</span>, <span class="number">0</span>, <span class="number">0</span>))) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">-1</span> == bRet) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::TranslateMessage(&amp;msg);</span><br><span class="line">    ::DispatchMessage(&amp;msg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Avoiding-Bottlenecks-in-Your-Window-Procedure"><a href="#Avoiding-Bottlenecks-in-Your-Window-Procedure" class="headerlink" title="Avoiding Bottlenecks in Your Window Procedure"></a>Avoiding Bottlenecks in Your Window Procedure</h4><p>While your window procedure executes, it blocks any other messages for windows created on the same thread. Therefore, avoid lengthy processing inside your window procedure. For example, suppose your program opens a TCP connection and waits indefinitely for the server to respond. If you do that inside the window procedure, your UI will not respond until the request completes. During that time, the window cannot process mouse or keyboard input, repaint itself, or even close.<br>Instead, you should move the work to another thread, using one of the multitasking facilities that are built into Windows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Create a new thread.</span><br><span class="line">Use a thread pool.</span><br><span class="line">Use asynchronous I/O calls.</span><br><span class="line">Use asynchronous procedure calls.</span><br></pre></td></tr></table></figure></p>
<h3 id="Painting-the-Window"><a href="#Painting-the-Window" class="headerlink" title="Painting the Window"></a>Painting the Window</h3><p>If you always paint the entire client area, the code will be simpler. If you have complicated painting logic, however, it can be more efficient to skip the areas outside of the update region.</p>
<h3 id="Closing-the-Window"><a href="#Closing-the-Window" class="headerlink" title="Closing the Window"></a>Closing the Window</h3><p>The WM_CLOSE message gives you an opportunity to prompt the user before closing the window.<br>When a window is about to be destroyed, it receives a WM_DESTROY message. This message is sent after the window is removed from the screen, but before the destruction occurs (in particular, before any child windows are destroyed).</p>
<h3 id="Managing-Application-State"><a href="#Managing-Application-State" class="headerlink" title="Managing Application State"></a>Managing Application State</h3><p>比较高级的用法，暂时跳过，一般用于写图形库。<br><a href="https://docs.microsoft.com/en-ca/windows/desktop/LearnWin32/managing-application-state-" target="_blank" rel="noopener">Managing Application State</a></p>

    </div>

    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">theForger</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2018/09/13/Using-COM-in-Your-Windows-Based-Program/" class="pre-post btn btn-default" title='Using COM in Your Windows-Based Program'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">Using COM in Your Windows-Based Program</span>
        </a>
    
    
        <a href="/2018/07/02/chromium-start/" class="next-post btn btn-default" title='chromium-learning'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">chromium-learning</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	
  <script id="dsq-count-scr" src="https://israel-liu.disqus.com/count.js" async></script>


<script type="text/javascript">
  var disqus_config = function () {
    this.page.url = 'https://israel-liu.github.io/2018/09/12/Get-Started-with-Win32-and-C/';
    this.page.identifier = '2018/09/12/Get-Started-with-Win32-and-C/';
    this.page.title = 'Get Started with Win32 and C++';
  };
  var d = document, s = d.createElement('script');
  s.src = 'https://israel-liu.disqus.com/embed.js';
  s.setAttribute('data-timestamp', '' + +new Date());
  (d.head || d.body).appendChild(s);
</script>


	

    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Get-Started-with-Win32-and-C"><span class="toc-text">Get Started with Win32 and C++</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Coding-Conventions"><span class="toc-text">Windows Coding Conventions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Boolean-Type"><span class="toc-text">Boolean Type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pointer-Precision-Types"><span class="toc-text">Pointer Precision Types</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Working-with-Strings"><span class="toc-text">Working with Strings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WinMain-The-Application-Entry-Point"><span class="toc-text">WinMain: The Application Entry Point</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Creating-a-Window"><span class="toc-text">Creating a Window</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Avoiding-Bottlenecks-in-Your-Window-Procedure"><span class="toc-text">Avoiding Bottlenecks in Your Window Procedure</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Painting-the-Window"><span class="toc-text">Painting the Window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Closing-the-Window"><span class="toc-text">Closing the Window</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Managing-Application-State"><span class="toc-text">Managing Application State</span></a>
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<!--<a id="toc-btn">
    <i class="fa fa-bars"></i>
</a>-->

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2017
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



	<script src="/js/search.js?rev=@@hash"></script>


<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>